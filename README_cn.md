<center>

# AI æ™ºèƒ½ Discord æ©Ÿå™¨äºº ğŸ¤–

[![python](https://img.shields.io/badge/-Python_3.10_%7C_3.11_%7C_3.12-blue?logo=python&logoColor=white)](https://python.org)
[![nextcord](https://img.shields.io/badge/-Nextcord-5865F2?logo=discord&logoColor=white)](https://github.com/nextcord/nextcord)
[![openai](https://img.shields.io/badge/-OpenAI-412991?logo=openai&logoColor=white)](https://openai.com)
[![Ruff](https://img.shields.io/endpoint?url=https://raw.githubusercontent.com/astral-sh/ruff/main/assets/badge/v2.json)](https://github.com/astral-sh/ruff)
[![tests](https://github.com/Mai0313/discordbot/actions/workflows/test.yml/badge.svg)](https://github.com/Mai0313/discordbot/actions/workflows/test.yml)
[![code-quality](https://github.com/Mai0313/discordbot/actions/workflows/code-quality-check.yml/badge.svg)](https://github.com/Mai0313/discordbot/actions/workflows/code-quality-check.yml)
[![codecov](https://codecov.io/gh/Mai0313/discordbot/branch/master/graph/badge.svg)](https://codecov.io/gh/Mai0313/discordbot)
[![license](https://img.shields.io/badge/License-MIT-green.svg?labelColor=gray)](https://github.com/Mai0313/discordbot/tree/master?tab=License-1-ov-file)
[![PRs](https://img.shields.io/badge/PRs-welcome-brightgreen.svg)](https://github.com/Mai0313/discordbot/pulls)
[![contributors](https://img.shields.io/github/contributors/Mai0313/discordbot.svg)](https://github.com/Mai0313/discordbot/graphs/contributors)

[**English**](./README.md) | **ç¹é«”ä¸­æ–‡**

</center>

åŸºæ–¼ **nextcord** æ¡†æ¶é–‹ç™¼çš„å…¨åŠŸèƒ½ Discord æ©Ÿå™¨äººï¼Œæä¾› AI æ™ºèƒ½å°è©±ã€å…§å®¹è™•ç†å’Œå¯¦ç”¨å·¥å…·åŠŸèƒ½ã€‚æ”¯æ´å¤šèªè¨€ä»‹é¢ã€å³æ™‚ä¸²æµå›æ‡‰å’Œè‡ªå‹•è¨Šæ¯å°å­˜ã€‚ğŸš€âš¡ğŸ”¥

_æ­¡è¿æä¾›å»ºè­°å’Œè²¢ç»ï¼_

## âœ¨ ä¸»è¦åŠŸèƒ½

### ğŸ¤– AI æ™ºèƒ½äº’å‹•

- **æ–‡å­—ç”Ÿæˆ**ï¼šæ”¯æ´å¤šç¨® OpenAI æ¨¡å‹ï¼ˆGPT-4oã€o1ã€o3-miniï¼‰èˆ‡å³æ™‚ä¸²æµå›æ‡‰
- **åœ–åƒè™•ç†**ï¼šè¦–è¦ºæ¨¡å‹æ”¯æ´ï¼Œè‡ªå‹•åœ–åƒæ ¼å¼è½‰æ›
- **ç¶²è·¯æœå°‹**ï¼šæ•´åˆ Perplexity APIï¼Œæä¾›å³æ™‚ç¶²è·¯æœå°‹èˆ‡æ‘˜è¦

### ğŸ“Š å…§å®¹è™•ç†

- **è¨Šæ¯æ‘˜è¦**ï¼šæ™ºèƒ½é »é“å°è©±æ‘˜è¦ï¼Œæ”¯æ´ç”¨æˆ¶ç¯©é¸
- **å½±ç‰‡ä¸‹è¼‰**ï¼šå¤šå¹³å°æ”¯æ´ï¼ˆYouTubeã€TikTokã€Instagramã€Xã€Facebookï¼‰
- **è¨Šæ¯å°å­˜**ï¼šè‡ªå‹•è¨˜éŒ„æ‰€æœ‰å°è©±è‡³ SQLite è³‡æ–™åº«

### ğŸŒ å¤šèªè¨€æ”¯æ´

- ç¹é«”ä¸­æ–‡
- ç°¡é«”ä¸­æ–‡
- æ—¥æœ¬èª
- English

### ğŸ”§ æŠ€è¡“ç‰¹è‰²

- æ¨¡çµ„åŒ– Cog æ¶æ§‹è¨­è¨ˆ
- éåŒæ­¥è™•ç†é…åˆ nextcord
- Pydantic åŸºç¤é…ç½®ç®¡ç†
- å®Œæ•´éŒ¯èª¤è™•ç†èˆ‡æ—¥èªŒè¨˜éŒ„
- Docker æ”¯æ´èˆ‡é–‹ç™¼å®¹å™¨

## ğŸ¯ æ ¸å¿ƒæŒ‡ä»¤

| æŒ‡ä»¤              | åŠŸèƒ½èªªæ˜           | ç‰¹è‰²åŠŸèƒ½             |
| ----------------- | ------------------ | -------------------- |
| `/oai`            | ç”Ÿæˆ AI æ–‡å­—å›æ‡‰   | å¤šæ¨¡å‹æ”¯æ´ã€åœ–åƒè¼¸å…¥ |
| `/oais`           | å³æ™‚ä¸²æµ AI å›æ‡‰   | å³æ™‚å›æ‡‰æ›´æ–°         |
| `/search`         | ç¶²è·¯æœå°‹èˆ‡ AI æ‘˜è¦ | Perplexity API æ•´åˆ  |
| `/sum`            | äº’å‹•å¼è¨Šæ¯æ‘˜è¦     | ç”¨æˆ¶ç¯©é¸ã€å¯é…ç½®æ•¸é‡ |
| `/download_video` | å¤šå¹³å°å½±ç‰‡ä¸‹è¼‰å™¨   | å“è³ªé¸é …ã€å¤§å°é©—è­‰   |
| `/ping`           | æ©Ÿå™¨äººæ•ˆèƒ½æ¸¬è©¦     | å»¶é²æ¸¬é‡             |

## ğŸš€ å¿«é€Ÿé–‹å§‹

### ç³»çµ±éœ€æ±‚

- Python 3.10 æˆ–æ›´é«˜ç‰ˆæœ¬
- Discord æ©Ÿå™¨äºº Token
- OpenAI API é‡‘é‘°
- Perplexity API é‡‘é‘°ï¼ˆç”¨æ–¼æœå°‹åŠŸèƒ½ï¼‰

### å®‰è£æ­¥é©Ÿ

1. **å…‹éš†å°ˆæ¡ˆ**

    ```bash
    git clone https://github.com/Mai0313/discordbot.git
    cd discordbot
    ```

2. **ä½¿ç”¨ uv å®‰è£ä¾è³´**

    ```bash
    # å¦‚æœå°šæœªå®‰è£ uv
    curl -LsSf https://astral.sh/uv/install.sh | sh

    # å®‰è£å°ˆæ¡ˆä¾è³´
    uv sync
    ```

3. **è¨­å®šç’°å¢ƒè®Šæ•¸**

    ```bash
    cp .env.example .env
    # ç·¨è¼¯ .env æª”æ¡ˆï¼Œå¡«å…¥ä½ çš„ API é‡‘é‘°å’Œè¨­å®š
    ```

4. **å•Ÿå‹•æ©Ÿå™¨äºº**

    ```bash
    uv run python main.py
    ```

### Docker éƒ¨ç½²

```bash
# ä½¿ç”¨ Docker Compose
docker-compose up -d

# æˆ–æ‰‹å‹•å»ºç«‹
docker build -t discordbot .
docker run -d discordbot
```

## âš™ï¸ é…ç½®è¨­å®š

### å¿…è¦ç’°å¢ƒè®Šæ•¸

```env
# Discord è¨­å®š
DISCORD_BOT_TOKEN=ä½ çš„_discord_æ©Ÿå™¨äºº_token
DISCORD_TEST_SERVER_ID=ä½ çš„_æ¸¬è©¦_ä¼ºæœå™¨_id  # å¯é¸

# OpenAI è¨­å®š
OPENAI_API_KEY=ä½ çš„_openai_api_é‡‘é‘°
OPENAI_BASE_URL=https://api.openai.com/v1
OPENAI_API_TYPE=openai  # æˆ– "azure"

# Azure OpenAIï¼ˆå¦‚æœä½¿ç”¨ Azureï¼‰
AZURE_OPENAI_API_KEY=ä½ çš„_azure_é‡‘é‘°
AZURE_OPENAI_ENDPOINT=https://your-resource.openai.azure.com

# Perplexity APIï¼ˆç”¨æ–¼æœå°‹ï¼‰
PERPLEXITY_API_KEY=ä½ çš„_perplexity_api_é‡‘é‘°

# è³‡æ–™åº«
SQLITE_FILE_PATH=data/messages.db
```

## ğŸ“ å°ˆæ¡ˆçµæ§‹

```
src/
â”œâ”€â”€ bot.py              # ä¸»è¦æ©Ÿå™¨äººå…¥å£é»
â”œâ”€â”€ cogs/               # æŒ‡ä»¤æ¨¡çµ„
â”‚   â”œâ”€â”€ gen_reply.py    # AI æ–‡å­—ç”Ÿæˆ
â”‚   â”œâ”€â”€ gen_search.py   # ç¶²è·¯æœå°‹æ•´åˆ
â”‚   â”œâ”€â”€ summary.py      # è¨Šæ¯æ‘˜è¦
â”‚   â”œâ”€â”€ video.py        # å½±ç‰‡ä¸‹è¼‰
â”‚   â”œâ”€â”€ gen_image.py    # åœ–åƒç”Ÿæˆï¼ˆé ç•™ï¼‰
â”‚   â””â”€â”€ template.py     # ç³»çµ±å·¥å…·
â”œâ”€â”€ sdk/                # æ ¸å¿ƒæ¥­å‹™é‚è¼¯
â”‚   â”œâ”€â”€ llm.py          # LLM æ•´åˆ
â”‚   â”œâ”€â”€ log_message.py  # è¨Šæ¯è¨˜éŒ„ç³»çµ±
â”‚   â””â”€â”€ asst.py         # Assistant API åŒ…è£å™¨
â”œâ”€â”€ types/              # é…ç½®æ¨¡å‹
â””â”€â”€ utils/              # å·¥å…·å‡½æ•¸
```

## ğŸ” æ ¸å¿ƒåŠŸèƒ½æ·±åº¦è§£æ

### è¨Šæ¯è¨˜éŒ„ç³»çµ±

æ©Ÿå™¨äººæœƒè‡ªå‹•è¨˜éŒ„æ‰€æœ‰é »é“å’Œç§è¨Šä¸­çš„ç”¨æˆ¶è¨Šæ¯ï¼š

- SQLite è³‡æ–™åº«å„²å­˜ï¼ˆ`data/messages.db`ï¼‰
- é™„ä»¶å’Œè²¼åœ–ä¿å­˜
- æŒ‰æ—¥æœŸçµ„ç¹”çš„æª”æ¡ˆçµæ§‹
- éš±ç§ä¿è­·ï¼ˆæ’é™¤æ©Ÿå™¨äººè¨Šæ¯ï¼‰

### å¤šæ¨¡æ…‹ AI æ”¯æ´

- æ–‡å­—å’Œåœ–åƒè¼¸å…¥è™•ç†
- è‡ªå‹•åœ–åƒè½‰ base64 æ ¼å¼
- æ¨¡å‹ç‰¹å®šé™åˆ¶è™•ç†
- ä¸²æµå›æ‡‰åŠŸèƒ½

### å½±ç‰‡ä¸‹è¼‰å¼•æ“

- æ”¯æ´ 10+ å€‹å¹³å°
- å“è³ªé¸æ“‡ï¼ˆ4K åˆ°ç´”éŸ³è¨Šï¼‰
- Discord æª”æ¡ˆå¤§å°é™åˆ¶é©—è­‰
- é€²åº¦è¿½è¹¤å’ŒéŒ¯èª¤è™•ç†

## ğŸ› ï¸ é–‹ç™¼æŒ‡å—

### æœ¬åœ°é–‹ç™¼

```bash
# å®‰è£é–‹ç™¼ä¾è³´
uv sync --dev

# åŸ·è¡Œæ¸¬è©¦
uv run pytest

# ç¨‹å¼ç¢¼å“è³ªæª¢æŸ¥
uv run ruff check
uv run ruff format

# å»ºç«‹æ–‡æª”
uv run mkdocs serve
```

### è²¢ç»æŒ‡å—

1. Fork æ­¤å°ˆæ¡ˆ
2. å»ºç«‹åŠŸèƒ½åˆ†æ”¯ï¼ˆ`git checkout -b feature/æ–°åŠŸèƒ½`ï¼‰
3. æäº¤è®Šæ›´ï¼ˆ`git commit -m 'æ–°å¢æŸé …åŠŸèƒ½'`ï¼‰
4. æ¨é€åˆ°åˆ†æ”¯ï¼ˆ`git push origin feature/æ–°åŠŸèƒ½`ï¼‰
5. å»ºç«‹ Pull Request

### ç¨‹å¼ç¢¼è¦ç¯„

- éµå¾ª PEP 8 å‘½åæ…£ä¾‹
- ä½¿ç”¨ Pydantic æ¨¡å‹é€²è¡Œè³‡æ–™é©—è­‰
- æ‰€æœ‰å‡½æ•¸éœ€è¦å‹åˆ¥æç¤º
- ä½¿ç”¨ Google é¢¨æ ¼çš„ docstring
- æœ€å¤§è¡Œé•·åº¦ 99 å­—å…ƒ

## ğŸ“š API åƒè€ƒ

### ä¸»è¦ SDK æ¨¡çµ„

#### `src/sdk/llm.py`

```python
# AI æ–‡å­—ç”Ÿæˆ
await get_oai_reply(messages, model="gpt-4o")

# ä¸²æµå›æ‡‰
async for chunk in get_oai_reply_stream(messages):
    print(chunk)

# ç¶²è·¯æœå°‹
result = await get_search_result(query)
```

#### `src/sdk/log_message.py`

```python
# è¨Šæ¯è¨˜éŒ„
logger = MessageLogger()
await logger.log_message(message)
```

## ğŸš€ éƒ¨ç½²

### ç”Ÿç”¢ç’°å¢ƒéƒ¨ç½²

1. **ç’°å¢ƒæº–å‚™**

    ```bash
    # è¨­å®šç”Ÿç”¢ç’°å¢ƒè®Šæ•¸
    export DISCORD_BOT_TOKEN="ç”Ÿç”¢ç’°å¢ƒtoken"
    export OPENAI_API_KEY="ç”Ÿç”¢ç’°å¢ƒé‡‘é‘°"
    ```

2. **Docker éƒ¨ç½²**

    ```bash
    docker-compose -f docker-compose.yaml up -d
    ```

3. **ç›£æ§è¨­å®š**

    - ä½¿ç”¨ Logfire é€²è¡Œæ—¥èªŒç›£æ§
    - è¨­å®šå¥åº·æª¢æŸ¥ç«¯é»
    - é…ç½®éŒ¯èª¤é€šçŸ¥

## ğŸ”§ ç–‘é›£æ’è§£

### å¸¸è¦‹å•é¡Œ

**Q: æ©Ÿå™¨äººç„¡æ³•å›æ‡‰æŒ‡ä»¤**
A: æª¢æŸ¥æ©Ÿå™¨äººæ¬Šé™ï¼Œç¢ºä¿å·²å•Ÿç”¨ã€Œæ‡‰ç”¨ç¨‹å¼æŒ‡ä»¤ã€ç¯„åœ

**Q: OpenAI API éŒ¯èª¤**
A: é©—è­‰ API é‡‘é‘°å’Œé¡åº¦ï¼Œæª¢æŸ¥æ¨¡å‹å¯ç”¨æ€§

**Q: å½±ç‰‡ä¸‹è¼‰å¤±æ•—**
A: ç¢ºèª yt-dlp ç‰ˆæœ¬ç‚ºæœ€æ–°ï¼Œæª¢æŸ¥å¹³å°æ”¯æ´ç‹€æ³

**Q: è³‡æ–™åº«é€£æ¥éŒ¯èª¤**
A: æª¢æŸ¥ SQLite æª”æ¡ˆè·¯å¾‘æ¬Šé™ï¼Œç¢ºä¿ç›®éŒ„å­˜åœ¨

### æ—¥èªŒåˆ†æ

```bash
# æª¢è¦–æ©Ÿå™¨äººæ—¥èªŒ
tail -f logs/bot.log

# æª¢æŸ¥éŒ¯èª¤æ—¥èªŒ
grep ERROR logs/bot.log
```

## ğŸ“ˆ æ•ˆèƒ½å„ªåŒ–

### å»ºè­°é…ç½®

- **è¨˜æ†¶é«”**ï¼šæœ€å°‘ 512MBï¼Œå»ºè­° 1GB
- **å„²å­˜ç©ºé–“**ï¼šæœ€å°‘ 2GBï¼ˆç”¨æ–¼è¨Šæ¯å’Œé™„ä»¶å„²å­˜ï¼‰
- **ç¶²è·¯**ï¼šç©©å®šçš„ç¶²éš›ç¶²è·¯é€£æ¥
- **CPU**ï¼šå¤šæ ¸å¿ƒè™•ç†å™¨ï¼Œæ”¯æ´å¤§é‡ä¸¦ç™¼è«‹æ±‚

### å„ªåŒ–æŠ€å·§

1. ä½¿ç”¨ Redis å¿«å–é »ç¹æŸ¥è©¢
2. å®šæœŸæ¸…ç†èˆŠçš„ä¸‹è¼‰æª”æ¡ˆ
3. é…ç½®é©ç•¶çš„ API è«‹æ±‚é™åˆ¶
4. ä½¿ç”¨é€£æ¥æ± å„ªåŒ–è³‡æ–™åº«é€£æ¥

## ğŸ“„ æˆæ¬Šæ¢æ¬¾

æœ¬å°ˆæ¡ˆæ¡ç”¨ MIT æˆæ¬Šæ¢æ¬¾ã€‚è©³ç´°è³‡è¨Šè«‹åƒé–± [LICENSE](LICENSE) æª”æ¡ˆã€‚

## ğŸ‘¥ è²¢ç»è€…

[![Contributors](https://contrib.rocks/image?repo=Mai0313/discordbot)](https://github.com/Mai0313/discordbot/graphs/contributors)

ä½¿ç”¨ [contrib.rocks](https://contrib.rocks) è£½ä½œ

## ğŸ“ è¯çµ¡æ–¹å¼

- ğŸ“§ Email: [å°ˆæ¡ˆç¶­è­·è€…éƒµç®±]
- ğŸ’¬ Discord: [Discord ä¼ºæœå™¨é€£çµ]
- ğŸ› Issue: [GitHub Issues](https://github.com/Mai0313/discordbot/issues)
- ğŸ’¡ è¨è«–: [GitHub Discussions](https://github.com/Mai0313/discordbot/discussions)

## ğŸ”— ç›¸é—œè³‡æº

- [å®˜æ–¹æ–‡æª”](https://mai0313.github.io/discordbot/)
- [Nextcord æ–‡æª”](https://docs.nextcord.dev/)
- [OpenAI API æ–‡æª”](https://platform.openai.com/docs)
- [Discord é–‹ç™¼è€…æ–‡æª”](https://discord.com/developers/docs)

---

<center>

**â­ å¦‚æœé€™å€‹å°ˆæ¡ˆå°ä½ æœ‰å¹«åŠ©ï¼Œè«‹çµ¦æˆ‘å€‘ä¸€å€‹æ˜Ÿæ˜Ÿï¼**

</center>
