# 楓之谷競標系統使用說明

## 功能概述

新增的競標系統為楓之谷 Discord Bot 提供了完整的拍賣功能，允許用戶創建物品拍賣並參與競標。

## 主要功能

### 1. 創建拍賣

- **指令**: `/auction_create`
- **功能**: 打開創建拍賣的互動式表單
- **需要輸入**:
    - 物品名稱 (最多100字元)
    - 起標價格 (楓幣，必須大於0)
    - 加價金額 (每次最少加價，必須大於0)
    - 拍賣時長 (1-168小時，預設24小時)

### 2. 查看拍賣列表

- **指令**: `/auction_list`
- **功能**: 顯示所有進行中的拍賣
- **特色**:
    - 顯示前5個拍賣的摘要
    - 提供下拉選單選擇特定拍賣查看詳情
    - 實時顯示剩餘時間和當前價格

### 3. 查看拍賣詳情

- **指令**: `/auction_info <拍賣編號>`
- **功能**: 查看特定拍賣的詳細資訊
- **顯示內容**:
    - 當前價格和加價金額
    - 當前領先者
    - 拍賣發起人
    - 剩餘時間和結束時間

### 4. 個人拍賣記錄

- **指令**: `/auction_my`
- **功能**: 查看個人的拍賣記錄
- **顯示內容**:
    - 我創建的拍賣
    - 我領先的拍賣

## 互動功能

### 拍賣互動面板

每個拍賣都有三個互動按鈕：

1. **💰 出價**: 開啟出價表單
2. **📊 查看記錄**: 顯示前10筆出價記錄
3. **🔄 刷新**: 更新拍賣資訊

### 出價規則

- 出價金額必須至少為「當前價格 + 加價金額」
- 拍賣創建者不能參與自己的拍賣
- 當前最高出價者不能重複出價
- 拍賣結束後不能再出價

## 資料庫結構

系統使用 SQLite 資料庫儲存資料，包含兩個主要表格：

### auctions 表

- `id`: 拍賣編號 (主鍵)
- `item_name`: 物品名稱
- `starting_price`: 起標價格
- `increment`: 加價金額
- `duration_hours`: 持續時間
- `creator_id`: 創建者 Discord ID
- `creator_name`: 創建者顯示名稱
- `created_at`: 創建時間
- `end_time`: 結束時間
- `current_price`: 當前最高價
- `current_bidder_id`: 當前最高出價者 ID
- `current_bidder_name`: 當前最高出價者名稱
- `is_active`: 是否活躍

### bids 表

- `id`: 出價記錄編號 (主鍵)
- `auction_id`: 對應的拍賣編號
- `bidder_id`: 出價者 Discord ID
- `bidder_name`: 出價者顯示名稱
- `amount`: 出價金額
- `timestamp`: 出價時間

## 技術特點

### 安全性

- 防止自己競標自己的拍賣
- 防止重複出價
- 價格驗證和範圍檢查
- 時間驗證防止過期拍賣出價

### 用戶體驗

- 實時更新拍賣資訊
- 直觀的互動式界面
- 多語言支援（繁中、簡中、日文、英文）
- 詳細的錯誤提示和成功回饋

### 效能優化

- SQLite 資料庫本地儲存
- 查詢優化和索引
- 限制顯示記錄數量避免過載

## 使用範例

### 創建拍賣

1. 輸入 `/auction_create`
2. 填寫表單：
    - 物品名稱：屠龍刀+15
    - 起標價格：5000000
    - 加價金額：500000
    - 拍賣時長：48
3. 點擊提交

### 參與競標

1. 使用 `/auction_list` 查看拍賣
2. 選擇感興趣的拍賣
3. 點擊「💰 出價」按鈕
4. 輸入出價金額
5. 確認出價

### 查看記錄

- 使用 `/auction_my` 查看個人記錄
- 點擊「📊 查看記錄」查看拍賣的出價歷史

## 注意事項

1. **資料庫位置**: 拍賣資料儲存在 `data/auctions.db`
2. **時區**: 所有時間都使用系統本地時間
3. **貨幣單位**: 統一使用「楓幣」作為貨幣單位
4. **拍賣結束**: 系統不會自動通知拍賣結束，需要手動檢查
5. **資料備份**: 建議定期備份 `data/auctions.db` 檔案

## 未來擴展可能

1. 自動結束拍賣通知
2. 拍賣歷史記錄
3. 物品圖片支援
4. 拍賣分類和搜尋
5. 競標提醒功能
6. 成交統計分析
